# 1. Установка

### 1.0. Установите git и git lfs

### 1.1. Скачайте репозиторий
```commandline
git lfs install
git clone https://github.com/Xalerablt/kinoteka
cd kinoteka
git clone https://huggingface.co/nomic-ai/nomic-embed-text-v2-moe ./nomic-ai/nomic-embed-text-v2-moe
git clone https://huggingface.co/nomic-ai/nomic-bert-2048 ./nomic-ai/nomic-bert-2048
```
### 1.2. Создайте виртуальное окружение (venv)
```commandline
python -m venv venv
```
### 1.3. Установка зависимостей
**Linux**:
```commandline
source venv/bin/activate
pip install -r requirements.txt
```
**Windows**:
```commandline
venv\Scripts\activate.bat
pip install -r requirements.txt
```
### 4. Запуск

```commandline
python app.py
```
### 5. Функции
Для активации поиска по описанию фильмов введите в строку поиска тег @ai

### Сайт будет доступен по ссылке - http://127.0.0.1:5000


# 2. Описание содержащихся файлов
- [**app.py**](/app.py) - файл с бэкенд-оформлением сайта
- [**search.py**](/search.py) - файл с алгоритмом поиска 
- [**recommend_film.py**](/recommend_film.py) - файл с алгоритмом предоставления рекомендаций к просмотру
- [**instance/films.json**](/instance/films.json) - База данных фильмов и их векторов
- [**instance/site.db**](/instance/site.db) - База данных пользователей
- [**templates**](/templates) - html-шаблоны страниц
- [**README.md**](/README.md) - инструкция
- [**requirements.txt**](/requirements.txt) - файл с зависимостями (библиотеками) для установки
- **nomic-ai** - веса моделей (устанавливаются в процессе)



# 3. Описание решения
### 3.1 Сбор данных
Для сбора данных был использован асинхронный подход с библиотекой aiohttp, что позволяет эффективно отправлять и обрабатывать запросы без блокировки основного потока программы. Эта технология помогает ускорить процесс получения данных с удаленных серверов и использовать многозадачность.

Для сбора пересказов фильмов мы использовали сайт spoilertime.ru, где были собраны краткие содержания фильмов, что позволяет предоставлять пользователю информацию о сюжете фильма без необходимости просмотра самого фильма.

Для получения дополнительной информации о фильмах, такой как жанры, год выпуска, актерский состав и прочее, мы использовали API сайта themoviedb.org (TMDb). Это API предоставляет обширные метаданные для большинства фильмов и сериалов, включая описание, рейтинг, дата выхода, жанр и другие данные, которые могут быть полезны для создания рекомендаций или предоставления подробной информации.

### 3.2 Выбор метода реализации поиска
Для реализации поиска по описаниям фильмов и запросам пользователя был выбран метод, основанный на сравнении векторов. Суть метода заключается в том, что каждое описание фильма и запрос пользователя преобразуются в векторы фиксированной длины, которые затем сравниваются между собой с использованием различных метрик схожести, например, косинусного расстояния.

Для создания этих векторов мы выбрали модель nomic-embed-text-v2-moe от Hugging Face, которая предназначена для встраивания текстов в пространстве высоких измерений. Эта модель позволяет преобразовывать текстовые данные в векторное представление, что делает их удобными для последующего сравнения. С использованием этой модели мы можем эффективно обрабатывать как запросы пользователей, так и описание фильмов, превращая их в векторы, что позволяет быстро и точно находить наиболее релевантные результаты.
### 3.3 Реализация интерфейса
**Фильтрация по жанрам и году выпуска:**

Для улучшения поиска и персонализации результатов, в систему добавлена возможность фильтрации фильмов по жанрам и году выпуска. В веб-интерфейсе пользователя предлагаются фильтры, которые позволяют уточнить запрос по этим параметрам. Например, можно задать фильтр по жанру (боевик, комедия, драма и т. д.) или по диапазону годов выпуска фильмов. Эта возможность предоставляет пользователю более точные результаты поиска, ограничивая их по критериям, которые могут быть важны.

**Фильтрация по жанрам:** 

Для каждого фильма, полученного с API TMDb, извлекаются его жанры. Пользователь может выбрать один или несколько жанров из списка, чтобы сузить результаты.

**Фильтрация по году выпуска:** 

В интерфейсе отображаются фильтры для выбора определенного года или диапазона лет. Это позволяет пользователю найти фильмы, которые были выпущены в заданный период.
Система профилей
Каждому пользователю предлагается создать профиль, который будет сохранять его предпочтения, оценки фильмов и другие персонализированные данные. В профиле могут храниться:

**Предпочтения пользователя:** 

Информация о жанрах, любимых акторах, предпочитаемых годах выпуска фильмов и других интересах. Это позволяет предоставлять персонализированные рекомендации, которые будут более точными.

**История просмотров:**

Пользователь может видеть историю своих запросов и оценок, а также те фильмы, которые он недавно просмотрел или оценил.

**Возможность ставить оценку на фильмы**

Каждый пользователь может ставить оценки фильмам, которые он посмотрел. Оценка производится по шкале от 1 до 10 (или другой шкале, в зависимости от предпочтений). Оценки сохраняются в профиле пользователя и могут быть использованы для:

**Система рекомендаций:** 

Если пользователь часто ставит высокие оценки фильмам определенного жанра, система может предложить больше фильмов этого жанра в будущем.

**Оценки популярности:** 

Средняя оценка фильма, которую поставили пользователи, будет отображаться на странице каждого фильма, что позволяет увидеть, насколько фильм понравился в целом.

**Возможность написания рецензий**

Кроме того, пользователи могут публиковать рецензии на фильмы. Это позволяет обсуждать фильмы, пользователи могут делиться своим мнением о фильмах, что создает дополнительный контент и взаимодействие в рамках платформы.
